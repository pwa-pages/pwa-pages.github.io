{"ast":null,"code":"import _asyncToGenerator from \"/home/pebblerye/pwa/pwa-pages.github.io/rosen-watcher-pwa/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { EventService, EventType } from './service/event.service';\nimport { ActivatedRoute } from '@angular/router';\nimport { ChainService } from './service/chain.service';\nimport { Address } from '../service/ts/models/address';\nimport { StorageService } from './service/storage.service';\nimport { DataService } from './service/data.service';\nimport { BrowserService } from './service/browser.service';\nimport * as i0 from \"@angular/core\";\nexport let BaseWatcherComponent = /*#__PURE__*/(() => {\n  class BaseWatcherComponent {\n    constructor(injector) {\n      this.injector = injector;\n      this.busyCounter = 1;\n      this.loaderLogs = [];\n      this.profile = null;\n      this.addresses = [];\n      this.noAddresses = false;\n      this.eventService = this.injector.get(EventService);\n      this.chainService = this.injector.get(ChainService);\n      this.storageService = this.injector.get(StorageService);\n      this.dataService = this.injector.get(DataService);\n      this.browserService = this.injector.get(BrowserService);\n      try {\n        this.route = this.injector.get(ActivatedRoute);\n      } catch {\n        this.route = undefined;\n      }\n    }\n    resetHeight() {\n      document.body.style.height = window.innerHeight + 'px';\n      document.documentElement.style.height = window.innerHeight + 'px';\n    }\n    ngOnInit() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        _this.eventService.sendEvent(EventType.SwipeActivated);\n        window.addEventListener('resize', _this.resetHeight);\n        _this.resetHeight();\n      })();\n    }\n    ngOnDestroy() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        _this2.eventService.sendEvent(EventType.SwipeDeActivated);\n        yield _this2.eventService.unSubscribeAll([EventType.RefreshInputs]);\n      })();\n    }\n    checkProfileParams(params) {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        if (params['profile']) {\n          const profileParam = params['profile'];\n          _this3.profile = profileParam;\n          console.log(profileParam);\n          _this3.storageService.initIndexedDB(profileParam);\n        }\n      })();\n    }\n    SetupRoute() {\n      var _this4 = this;\n      this.route?.queryParams.subscribe(/*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (params) {\n          yield _this4.checkProfileParams(params);\n          yield _this4.checkAddressParams(params);\n        });\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    }\n    checkAddressParams(params) {\n      var _this5 = this;\n      return _asyncToGenerator(function* () {\n        if (params['addresses'] || Object.keys(params).some(key => key.startsWith('address'))) {\n          const addressesParam = params['addresses'];\n          console.log(addressesParam);\n          _this5.addresses = [];\n          if (addressesParam != null) {\n            _this5.addresses = JSON.parse(decodeURIComponent(addressesParam));\n          }\n          const individualAddresses = Object.keys(params).filter(key => key.startsWith('address') && !key.startsWith('addresses')).map(key => new Address(params[key], _this5.chainService.getChainType(params[key]))).filter(addr => addr !== undefined && addr !== null);\n          individualAddresses.forEach(i => _this5.addresses.push(i));\n          _this5.browserService.replacePath();\n          yield _this5.storageService.putAddressData(_this5.addresses);\n          yield _this5.storageService.clearInputsStore();\n          if (_this5.addresses.length == 0) {\n            _this5.noAddresses = true;\n          }\n          return true;\n        } else {\n          _this5.addresses = yield _this5.dataService.getAddresses();\n          if (_this5.addresses.length == 0) {\n            _this5.noAddresses = true;\n          }\n          return false;\n        }\n      })();\n    }\n    subscribeToEvent(eventType, callback) {\n      var _this6 = this;\n      return _asyncToGenerator(function* () {\n        const eventCallBack = callback;\n        yield _this6.eventService.subscribeToEvent(eventType, eventCallBack);\n      })();\n    }\n    subscribeToEvents(eventTypes, callback) {\n      var _this7 = this;\n      return _asyncToGenerator(function* () {\n        eventTypes.forEach(/*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator(function* (eventType) {\n            yield _this7.eventService.subscribeToEvent(eventType, callback);\n          });\n          return function (_x2) {\n            return _ref2.apply(this, arguments);\n          };\n        }());\n      })();\n    }\n    static {\n      this.ɵfac = function BaseWatcherComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || BaseWatcherComponent)(i0.ɵɵdirectiveInject(i0.Injector));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: BaseWatcherComponent,\n        selectors: [[\"app-root\"]],\n        decls: 0,\n        vars: 0,\n        template: function BaseWatcherComponent_Template(rf, ctx) {},\n        encapsulation: 2\n      });\n    }\n  }\n  return BaseWatcherComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}
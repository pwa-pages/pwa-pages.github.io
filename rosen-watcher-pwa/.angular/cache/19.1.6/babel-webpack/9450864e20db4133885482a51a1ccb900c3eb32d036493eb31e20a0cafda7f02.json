{"ast":null,"code":"import _asyncToGenerator from \"/home/pebblerye/pwa/pwa-pages.github.io/rosen-watcher-pwa/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { effect, EventEmitter } from '@angular/core';\nimport { EventType } from '../service/event.service';\nimport { WatchersStats } from '../service/watchers.data.service';\nimport { BaseWatcherComponent } from '../basewatchercomponent';\nimport { ChainType } from '../../service/ts/models/chaintype';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../service/watchers.data.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction WatchersComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 2)(1, \"div\", 3);\n    i0.ɵɵtext(2, \" Number of watchers: \");\n    i0.ɵɵelementStart(3, \"div\", 4);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r0.watchersStats.totalWatcherCount);\n  }\n}\nfunction WatchersComponent_div_1_ng_container_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"div\");\n    i0.ɵɵelementStart(2, \"div\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\");\n    i0.ɵɵtext(9);\n    i0.ɵɵpipe(10, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"div\");\n    i0.ɵɵtext(12);\n    i0.ɵɵpipe(13, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const chainType_r3 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵclassMapInterpolate1(\"\", chainType_r3, \" watchersdispl\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(chainType_r3);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.watchersStats.chainWatcherCount[chainType_r3]);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\" \", ctx_r0.watchersStats.chainPermitCount[chainType_r3], \" (\", ctx_r0.watchersStats.activePermitCount[chainType_r3], \") \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(10, 9, ctx_r0.watchersStats.chainLockedRSN[chainType_r3], \"1.0-0\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(13, 12, ctx_r0.watchersStats.chainLockedERG[chainType_r3], \"1.0-0\"));\n  }\n}\nfunction WatchersComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"div\", 6)(2, \"div\", 7)(3, \"div\", 8);\n    i0.ɵɵtext(4, \"Watcher requirements:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 9)(6, \"label\", 10);\n    i0.ɵɵtext(7, \"Currency:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"select\", 11);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function WatchersComponent_div_1_Template_select_ngModelChange_8_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r0.selectedCurrency, $event) || (ctx_r0.selectedCurrency = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵlistener(\"change\", function WatchersComponent_div_1_Template_select_change_8_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.onCurrencyChange());\n    });\n    i0.ɵɵelementStart(9, \"option\", 12);\n    i0.ɵɵtext(10, \"Euro\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"option\", 13);\n    i0.ɵɵtext(12, \"US Dollar\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"option\", 14);\n    i0.ɵɵtext(14, \"Ergo\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"option\", 15);\n    i0.ɵɵtext(16, \"Rosen\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(17, \"div\", 16);\n    i0.ɵɵtext(18);\n    i0.ɵɵpipe(19, \"number\");\n    i0.ɵɵpipe(20, \"number\");\n    i0.ɵɵelement(21, \"br\");\n    i0.ɵɵtext(22);\n    i0.ɵɵpipe(23, \"number\");\n    i0.ɵɵpipe(24, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"div\", 17);\n    i0.ɵɵtext(26, \"Watchers stats:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(27, \"div\", 18);\n    i0.ɵɵelementStart(28, \"div\", 19);\n    i0.ɵɵtext(29, \"Chain\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(30, \"div\", 19);\n    i0.ɵɵtext(31, \"Watchers\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(32, \"div\", 19);\n    i0.ɵɵtext(33, \"Permits (Active)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(34, \"div\", 19);\n    i0.ɵɵtext(35, \"Locked RSN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(36, \"div\", 19);\n    i0.ɵɵtext(37, \"Locked ERG\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(38, WatchersComponent_div_1_ng_container_38_Template, 14, 15, \"ng-container\", 20);\n    i0.ɵɵelement(39, \"div\", 21);\n    i0.ɵɵelementStart(40, \"div\");\n    i0.ɵɵtext(41, \"\\u00A0\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(42, \"div\");\n    i0.ɵɵtext(43, \"\\u00A0\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(44, \"div\")(45, \"div\")(46, \"div\")(47, \"div\", 21);\n    i0.ɵɵelementStart(48, \"div\");\n    i0.ɵɵtext(49, \"Total\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(50, \"div\");\n    i0.ɵɵtext(51);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(52, \"div\");\n    i0.ɵɵtext(53);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(54, \"div\");\n    i0.ɵɵtext(55);\n    i0.ɵɵpipe(56, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(57, \"div\");\n    i0.ɵɵtext(58);\n    i0.ɵɵpipe(59, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(60, \"div\", 21);\n    i0.ɵɵtext(61, \"\\u00A0\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(62, \"div\", 22);\n    i0.ɵɵtext(63, \"\\u00A0\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(64, \"div\", 21);\n    i0.ɵɵelementStart(65, \"div\", 22);\n    i0.ɵɵtext(66);\n    i0.ɵɵpipe(67, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(68, \"br\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(8);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r0.selectedCurrency);\n    i0.ɵɵadvance(10);\n    i0.ɵɵtextInterpolate4(\" Watcher collateral: \", i0.ɵɵpipeBind2(19, 16, ctx_r0.watchersStats.watcherCollateralRSN, \"1.0-0\"), \" RSN + \", ctx_r0.watchersStats.watcherCollateralERG, \" ERG = \", i0.ɵɵpipeBind2(20, 19, ctx_r0.getWatcherAmounts().watcherValue, \"1.0-0\"), \" \", ctx_r0.selectedCurrency, \" \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate3(\" Permit value: \", i0.ɵɵpipeBind2(23, 22, ctx_r0.watchersStats.permitCost, \"1.0-0\"), \" RSN = \", i0.ɵɵpipeBind2(24, 25, ctx_r0.getWatcherAmounts().permitValue, \"1.0-0\"), \" \", ctx_r0.selectedCurrency, \" \");\n    i0.ɵɵadvance(16);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.getChainTypes());\n    i0.ɵɵadvance(13);\n    i0.ɵɵtextInterpolate(ctx_r0.watchersStats.totalWatcherCount);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r0.watchersStats.totalPermitCount, \" (\", ctx_r0.watchersStats.totalActivePermitCount, \")\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(56, 28, ctx_r0.watchersStats.totalLockedRSN, \"1.0-0\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(59, 31, ctx_r0.watchersStats.totalLockedERG, \"1.0-0\"));\n    i0.ɵɵadvance(8);\n    i0.ɵɵtextInterpolate2(\" Total locked: \", i0.ɵɵpipeBind2(67, 34, ctx_r0.getWatcherAmounts().totalLocked, \"1.0-0\"), \" \", ctx_r0.selectedCurrency, \" (permits + collateral) \");\n  }\n}\nexport let WatchersComponent = /*#__PURE__*/(() => {\n  class WatchersComponent extends BaseWatcherComponent {\n    set renderHtml(value) {\n      // Treat 'false' string or false boolean as false, otherwise true\n      this._renderHtml = value === false || value === 'false' ? false : true;\n    }\n    get renderHtml() {\n      return this._renderHtml;\n    }\n    isHtmlRenderEnabled() {\n      return this._renderHtml;\n    }\n    constructor(injector, watchersDataService) {\n      super(injector);\n      this.watchersDataService = watchersDataService;\n      this._renderHtml = true;\n      this.notifyWatchersStatsChanged = new EventEmitter();\n      this.watchersStats = new WatchersStats();\n      this.selectedCurrency = '';\n      const watcherStats = this.watchersDataService.getWatcherStats();\n      effect(() => {\n        this.watchersStats = watcherStats();\n        this.notifyWatchersStatsChanged.emit(this.watchersStats);\n      });\n    }\n    onCurrencyChange() {\n      localStorage.setItem('selectedCurrency', this.selectedCurrency);\n    }\n    getChainTypes() {\n      return Object.values(ChainType);\n    }\n    getWatcherAmounts() {\n      return this.watchersStats.watchersAmountsPerCurrency[this.selectedCurrency];\n    }\n    ngOnInit() {\n      var _superprop_getNgOnInit = () => super.ngOnInit,\n        _this = this;\n      return _asyncToGenerator(function* () {\n        _superprop_getNgOnInit().call(_this);\n        _this.selectedCurrency = localStorage.getItem('selectedCurrency');\n        _this.selectedCurrency = _this.selectedCurrency == null ? Currency.EUR : _this.selectedCurrency;\n        _this.watchersDataService.download();\n        _this.eventService.sendEvent(EventType.WatchersScreenLoaded);\n      })();\n    }\n    static {\n      this.ɵfac = function WatchersComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || WatchersComponent)(i0.ɵɵdirectiveInject(i0.Injector), i0.ɵɵdirectiveInject(i1.WatchersDataService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: WatchersComponent,\n        selectors: [[\"app-watchers\"]],\n        inputs: {\n          renderHtml: \"renderHtml\"\n        },\n        outputs: {\n          notifyWatchersStatsChanged: \"notifyWatchersStatsChanged\"\n        },\n        features: [i0.ɵɵInheritDefinitionFeature],\n        decls: 2,\n        vars: 2,\n        consts: [[\"class\", \"headercontainer\", 4, \"ngIf\"], [\"class\", \"watchersmaincontainer main-content\", 4, \"ngIf\"], [1, \"headercontainer\"], [1, \"headerblock\"], [1, \"header\"], [1, \"watchersmaincontainer\", \"main-content\"], [1, \"watcherscontainer\"], [1, \"currencyrow\"], [1, \"watcherrequirements\"], [1, \"currency\"], [\"for\", \"currencySelect\"], [\"id\", \"currencySelect\", 3, \"ngModelChange\", \"change\", \"ngModel\"], [\"value\", \"EUR\"], [\"value\", \"USD\"], [\"value\", \"ERG\"], [\"value\", \"RSN\"], [1, \"watchervaluerow\", \"collateralvalues\"], [1, \"fullrow\"], [1, \"watcherheader\", \"first\"], [1, \"watcherheader\"], [4, \"ngFor\", \"ngForOf\"], [1, \"watchersdispl\"], [1, \"fivecolumns\"]],\n        template: function WatchersComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵtemplate(0, WatchersComponent_div_0_Template, 5, 1, \"div\", 0)(1, WatchersComponent_div_1_Template, 69, 37, \"div\", 1);\n          }\n          if (rf & 2) {\n            i0.ɵɵproperty(\"ngIf\", ctx.isHtmlRenderEnabled());\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.isHtmlRenderEnabled());\n          }\n        },\n        dependencies: [CommonModule, i2.NgForOf, i2.NgIf, i2.DecimalPipe, FormsModule, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgModel],\n        encapsulation: 2\n      });\n    }\n  }\n  return WatchersComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}